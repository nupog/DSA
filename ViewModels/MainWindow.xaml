<Window x:Class="DeepSeekSurveyAnalyzer.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Анализатор опросов DeepSeek" Height="550" Width="800"
        WindowStartupLocation="CenterScreen">
    <!-- Используем глобальные ресурсы из App.xaml -->
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Шестерёнка настроек -->
        <Button Grid.Row="0" HorizontalAlignment="Right" Width="30" Height="30" 
                Command="{Binding OpenSettingsCommand}" Background="Transparent" BorderThickness="0">
            <Image Source="/Images/gear.png" Stretch="Uniform"/>
        </Button>

        <!-- Загрузка файлов -->
        <GroupBox Grid.Row="1" Header="Загрузите результат опроса" Margin="0,10,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <StackPanel Orientation="Horizontal" Margin="5">
                    <Button Content="Выбрать файлы" Command="{Binding AddFilesCommand}" Padding="10,5"/>
                    <Button Content="Очистить" Command="{Binding ClearFilesCommand}" Margin="10,0,0,0" Padding="10,5"/>
                </StackPanel>
                <ListBox Grid.Row="1" ItemsSource="{Binding SelectedFiles}" Margin="5" 
                         AllowDrop="True" Drop="ListBox_Drop" DragEnter="ListBox_DragEnter">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding}" ToolTip="{Binding}" VerticalAlignment="Center"/>
                                <Button Content="X" Margin="5,0,0,0" Command="{Binding DataContext.RemoveFileCommand, RelativeSource={RelativeSource AncestorType=ListBox}}" CommandParameter="{Binding}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </GroupBox>

        <!-- Промт -->
        <GroupBox Grid.Row="2" Header="Промт:" Margin="0,10,0,0">
            <TextBox Text="{Binding PromptText, UpdateSourceTrigger=PropertyChanged}" 
                     AcceptsReturn="True" TextWrapping="Wrap" MinHeight="100" Margin="5"/>
        </GroupBox>

        <!-- Прогресс -->
        <TextBlock Grid.Row="3" Text="{Binding ProgressMessage}" Margin="5" Foreground="Gray" 
                   Visibility="{Binding IsBusy, Converter={StaticResource BoolToVis}}"/>

        <!-- Кнопка отправки -->
        <Button Grid.Row="4" Content="Отправить на обработку" Command="{Binding SendCommand}" 
                Height="40" FontSize="16" Margin="0,10,0,0" IsEnabled="{Binding IsBusy, Converter={StaticResource InverseBooleanConverter}}"/>
    </Grid>
</Window>